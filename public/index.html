<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Administração do Bot</title>
    <link rel="stylesheet" href="admin.css">
    <script src="admin.js?v=1.1"></script>
</head>
<body>
    <div class="container">
        <h1>Painel de Administração do Bot Pavlov</h1>
        <div id="responseMessageGlobal" class="response-message"></div>

        <section id="configSection">
            <h2>Configurações Gerais do Bot</h2>
            <form id="configForm">
                <div class="form-group">
                    <label for="config_GROUP_BASE_NAME">Nome Base do Grupo:</label>
                    <input type="text" id="config_GROUP_BASE_NAME" name="GROUP_BASE_NAME">
                </div>
                <div class="form-group">
                    <label for="config_TARGET_GROUP_ID">ID do Grupo (JID):</label>
                    <input type="text" id="config_TARGET_GROUP_ID" name="TARGET_GROUP_ID">
                </div>
                
                <h3>Horários do Servidor (HH:MM)</h3>
                <div class="form-group">
                    <label for="config_SERVER_OPEN_TIME">Hora de Abertura:</label>
                    <input type="time" id="config_SERVER_OPEN_TIME" name="SERVER_OPEN_TIME">
                </div>
                <div class="form-group">
                    <label for="config_SERVER_CLOSE_TIME">Hora de Fechamento:</label>
                    <input type="time" id="config_SERVER_CLOSE_TIME" name="SERVER_CLOSE_TIME">
                </div>

                <h3>Mensagens Automáticas (Servidor Aberto)</h3>
                <div class="form-group">
                    <label for="config_MESSAGES_DURING_SERVER_OPEN">Qtd. Mensagens (Servidor Aberto):</label>
                    <input type="number" id="config_MESSAGES_DURING_SERVER_OPEN" name="MESSAGES_DURING_SERVER_OPEN" min="0">
                </div>

                <h3>Mensagens Automáticas (Diurnas)</h3>
                <div class="form-group">
                    <label for="config_MESSAGES_DURING_DAYTIME">Qtd. Mensagens (Diurnas):</label>
                    <input type="number" id="config_MESSAGES_DURING_DAYTIME" name="MESSAGES_DURING_DAYTIME" min="0">
                </div>
                <div class="form-group">
                    <label for="config_DAYTIME_START_HOUR">Início Horário Diurno (0-23):</label>
                    <input type="number" id="config_DAYTIME_START_HOUR" name="DAYTIME_START_HOUR" min="0" max="23">
                </div>
                <div class="form-group">
                    <label for="config_DAYTIME_END_HOUR">Fim Horário Diurno (0-23):</label>
                    <input type="number" id="config_DAYTIME_END_HOUR" name="DAYTIME_END_HOUR" min="0" max="23">
                </div>

                <h3>Mensagens Automáticas (Dicas e Piadas)</h3>
                <div class="form-group">
                    <label for="config_MESSAGES_TIPS_PER_DAY">Qtd. Dicas de Jogo por Dia:</label>
                    <input type="number" id="config_MESSAGES_TIPS_PER_DAY" name="MESSAGES_TIPS_PER_DAY" min="0">
                </div>
                <div class="form-group">
                    <label for="config_MESSAGES_JOKES_PER_DAY">Qtd. Piadas por Dia:</label>
                    <input type="number" id="config_MESSAGES_JOKES_PER_DAY" name="MESSAGES_JOKES_PER_DAY" min="0">
                </div>
                
                <h3>Funcionalidades Adicionais</h3>
                <div class="form-group">
                    <label for="config_CHAT_SUMMARY_COUNT_PER_DAY">Qtd. Resumos do Chat por Dia:</label>
                    <input type="number" id="config_CHAT_SUMMARY_COUNT_PER_DAY" name="CHAT_SUMMARY_COUNT_PER_DAY" min="1" max="24">
                </div>
                <div class="form-group">
                    <label for="config_CHAT_SUMMARY_TIMES">Horários dos Resumos (HH:MM, separado por vírgula):</label>
                    <input type="text" id="config_CHAT_SUMMARY_TIMES" name="CHAT_SUMMARY_TIMES" placeholder="Ex: 09:00,21:00">
                </div>
                <div class="form-group">
                    <label for="config_POLL_MENTION_EVERYONE">Mencionar Todos em Enquetes:</label>
                    <input type="checkbox" id="config_POLL_MENTION_EVERYONE" name="POLL_MENTION_EVERYONE">
                    <span class="checkbox-label-text">Ativar (se desativado, mencionará participantes individualmente)</span>
                </div>
                <div class="form-group">
                    <label for="config_CHAT_SUMMARY_ENABLED">Resumo Automático do Chat:</label>
                    <input type="checkbox" id="config_CHAT_SUMMARY_ENABLED" name="CHAT_SUMMARY_ENABLED">
                    <span class="checkbox-label-text">Ativar resumo automático do chat</span>
                </div>
                <button type="submit">Salvar Configurações Gerais</button>
            </form>
            <div id="responseMessageConfig" class="response-message"></div>
        </section>

        <hr>

        <section id="messagesSection">
            <h2>Gerenciamento de Mensagens</h2>
            <p>Aqui você pode editar as mensagens que o bot utiliza. Clique em "Salvar Mensagens" após fazer as alterações.</p>
            <p><strong>Nota:</strong> Para mensagens que são uma lista (como "Novo Membro"), adicione cada nova mensagem em uma nova linha dentro da caixa de texto.</p>

            <form id="messagesForm">
                <h3>Status do Servidor</h3>
                <div class="message-config-group">
                    <label for="status_closed" class="message-type-label">Status: Fechado</label>
                    <textarea id="status_closed" name="status_closed" rows="2" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="status_closed">Sugerir com IA</button>
                            <div id="aiSpinner_status_closed" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_status_closed" name="aiUsage_status_closed">
                            <label for="aiUsage_status_closed" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>
                <div class="message-config-group">
                    <label for="status_openingSoon" class="message-type-label">Status: Abrindo em Breve</label>
                    <textarea id="status_openingSoon" name="status_openingSoon" rows="2" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="status_openingSoon">Sugerir com IA</button>
                            <div id="aiSpinner_status_openingSoon" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_status_openingSoon" name="aiUsage_status_openingSoon">
                            <label for="aiUsage_status_openingSoon" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>
                <div class="message-config-group">
                    <label for="status_open" class="message-type-label">Status: Aberto</label>
                    <textarea id="status_open" name="status_open" rows="2" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="status_open">Sugerir com IA</button>
                            <div id="aiSpinner_status_open" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_status_open" name="aiUsage_status_open">
                            <label for="aiUsage_status_open" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <h3>Boas-vindas e Despedidas</h3>
                <div class="message-config-group">
                    <label for="newMember" class="message-type-label">Novo Membro (uma por linha):</label>
                    <textarea id="newMember" name="newMember" rows="5" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="newMember">Sugerir com IA</button>
                            <div id="aiSpinner_newMember" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_newMember" name="aiUsage_newMember">
                            <label for="aiUsage_newMember" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>
                <div class="message-config-group">
                    <label for="memberLeft" class="message-type-label">Membro Saiu (uma por linha):</label>
                    <textarea id="memberLeft" name="memberLeft" rows="5" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="memberLeft">Sugerir com IA</button>
                            <div id="aiSpinner_memberLeft" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_memberLeft" name="aiUsage_memberLeft">
                            <label for="aiUsage_memberLeft" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <h3>Mensagens Aleatórias (Servidor Ativo)</h3>
                <div class="message-config-group">
                    <label for="randomActive" class="message-type-label">Mensagens Aleatórias (uma por linha):</label>
                    <textarea id="randomActive" name="randomActive" rows="8" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" id="generateAIMessageBtn" class="generate-ai-btn" data-message-type="randomActive">Sugerir com IA (Groq)</button>
                            <div id="aiMessageSpinner" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_randomActive" name="aiUsage_randomActive">
                            <label for="aiUsage_randomActive" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                
                <h3>Mensagens Aleatórias (Durante o Jogo)</h3>
                <div class="message-config-group">
                    <label for="inGameRandom" class="message-type-label">Mensagens (uma por linha) - Usadas quando o servidor está aberto:</label>
                    <textarea id="inGameRandom" name="inGameRandom" rows="8" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" id="generateAIInGameMessageBtn" class="generate-ai-btn" data-message-type="inGameRandom">Sugerir com IA</button>
                            <div id="aiMessageSpinnerInGameRandom" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_inGameRandom" name="aiUsage_inGameRandom">
                            <label for="aiUsage_inGameRandom" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <h3>Dicas do Jogo (Pavlov Tips)</h3>
                <div class="message-config-group">
                    <label for="gameTips" class="message-type-label">Dicas (uma por linha):</label>
                    <textarea id="gameTips" name="gameTips" rows="8" placeholder="Digite as dicas do jogo aqui, uma por linha..."></textarea>
                    <!-- Opcional: Botão de IA para dicas, se desejado no futuro -->
                    <!--
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="gameTip">Sugerir Dica com IA</button>
                            <div id="aiSpinner_gameTip" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                    </div>
                    -->
                </div>

                <h3>Piadas Aleatórias</h3>
                <div class="message-config-group">
                    <label for="randomJokes" class="message-type-label">Piadas (uma por linha):</label>
                    <textarea id="randomJokes" name="randomJokes" rows="8" placeholder="Digite as piadas aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="randomJoke">Sugerir Piada com IA</button>
                            <div id="aiSpinner_randomJoke" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_randomJoke" name="aiUsage_randomJoke">
                            <label for="aiUsage_randomJoke" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <h3>Extras</h3>
                <div class="message-config-group">
                    <label for="extras_sundayNight" class="message-type-label">Domingo à Noite:</label>
                    <textarea id="extras_sundayNight" name="extras_sundayNight" rows="2" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="extras_sundayNight">Sugerir com IA</button>
                            <div id="aiSpinner_extras_sundayNight" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_extras_sundayNight" name="aiUsage_extras_sundayNight">
                            <label for="aiUsage_extras_sundayNight" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>
                <div class="message-config-group">
                    <label for="extras_friday" class="message-type-label">Sexta-feira:</label>
                    <textarea id="extras_friday" name="extras_friday" rows="2" placeholder="Digite as mensagens aqui, uma por linha..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="extras_friday">Sugerir com IA</button>
                            <div id="aiSpinner_extras_friday" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_extras_friday" name="aiUsage_extras_friday">
                            <label for="aiUsage_extras_friday" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <h3>Mensagens de Deleção</h3>
                <div class="message-config-group">
                    <label for="messageDeleted" class="message-type-label">Frases para Mensagem Apagada (uma por linha):</label>
                    <textarea id="messageDeleted" name="messageDeleted" rows="5" placeholder="Ex: [NomeDoRemetente] tentou esconder algo..."></textarea>
                    <div class="message-options">
                        <div class="ai-manual-generate">
                            <button type="button" class="generate-ai-btn" data-message-type="messageDeleted">Sugerir com IA</button>
                            <div id="aiSpinner_messageDeleted" class="ai-spinner" style="display: none;">Gerando...</div>
                        </div>
                        <div class="ai-auto-toggle">
                            <input type="checkbox" id="aiUsage_messageDeleted" name="aiUsage_messageDeleted">
                            <label for="aiUsage_messageDeleted" class="checkbox-label">Usar IA automaticamente</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="save-button">Salvar Mensagens e Configurações de IA</button>
            </form>
            <div id="responseMessageMessages" class="response-message"></div>
        </section>
        <section id="jsonReplaceSection" class="bg-gray-50 p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">Substituir Configurações de Mensagens via JSON</h2>
            <p class="text-sm text-gray-600 mb-3">
                Cole o conteúdo JSON completo (similar ao antigo arquivo <code>messages.json</code>) abaixo para substituir todas as configurações de mensagens, prompts e uso da IA no banco de dados.
            </p>
            <p class="text-sm text-red-600 mb-1 font-semibold">
                Atenção: Esta ação é irreversível e substituirá todos os dados atuais de mensagens e prompts.
            </p>
            <p class="text-xs text-gray-500 mb-4">
                Certifique-se de que o JSON esteja bem formatado e contenha todas as chaves esperadas. Campos ausentes no JSON podem ser preenchidos com valores padrão.
            </p>
            <div class="mb-4">
                <label for="replaceAllMessagesJson" class="block text-gray-700 text-sm font-bold mb-2">Conteúdo JSON Completo:</label>
                <textarea id="replaceAllMessagesJson" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline h-72 bg-white" placeholder="Cole o JSON completo aqui..."></textarea>
            </div>
            <button id="replaceAllMessagesBtn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline flex items-center justify-center transition duration-150 ease-in-out">
                <svg id="replaceAllSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Substituir Todas as Configurações de Mensagens com este JSON
            </button>
            <div id="responseMessageReplaceAll" class="mt-4 p-3 rounded-md text-center hidden"></div>
        </section>

        <hr>

        <section id="chatHistoryManagementSection">
            <h2>Gerenciamento do Histórico de Chat (Banco de Dados)</h2>
            <p>Visualize o histórico de mensagens usado para resumos, simule um resumo ou limpe o histórico do banco de dados.</p>
            <div class="form-group">
                <button type="button" id="loadDbChatHistoryBtn">Carregar Histórico do Chat (DB)</button>
                <div id="dbChatHistorySpinner" class="ai-spinner" style="display: none;">Carregando histórico...</div>
            </div>
            <div class="form-group">
                <label for="dbChatHistoryTextarea">Histórico de Chat (Conteúdo do DB):</label>
                <textarea id="dbChatHistoryTextarea" rows="10" readonly placeholder="O histórico do chat do banco de dados aparecerá aqui..."></textarea>
            </div>
            <div class="form-group">
                <button type="button" id="simulateSummaryBtn">Simular Resumo do Histórico Acima</button>
                <div id="simulateSummarySpinner" class="ai-spinner" style="display: none;">Gerando resumo...</div>
            </div>
            <div class="form-group">
                <label for="simulatedSummaryResult">Resultado da Simulação do Resumo:</label>
                <textarea id="simulatedSummaryResult" rows="5" readonly placeholder="O resumo simulado aparecerá aqui..."></textarea>
            </div>
             <div class="form-group">
                <button type="button" id="clearDbChatHistoryBtn" class="danger-button">Limpar TODO Histórico de Chat (DB)</button>
                <div id="clearDbChatHistorySpinner" class="ai-spinner" style="display: none;">Limpando...</div>
            </div>
            <div id="responseMessageChatHistory" class="response-message"></div>
        </section>

        <hr>

        <section id="aiPromptsSection">
            <h2>Prompts da Inteligência Artificial</h2>
            <p>Edite os prompts base usados para gerar mensagens com IA. Estes serão usados tanto pelas funções automáticas do bot quanto pelos botões "Gerar com IA" acima.</p>
            <p><strong>Lembre-se:</strong> Os prompts são salvos juntamente com as outras mensagens e configurações de IA através do botão "Salvar Mensagens e Configurações de IA" na seção anterior.</p>
            <div class="form-group">
                <label for="aiPrompt_systemPrompt">Prompt Mestre do Sistema (Persona do Bot):</label>
                <textarea id="aiPrompt_systemPrompt" name="aiPrompt_systemPrompt" rows="8" placeholder="Defina aqui a personalidade principal, contexto e instruções gerais para a IA do bot Audozappo..."></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_randomActive">Prompt para "Mensagem Aleatória (Geral)":</label>
                <textarea id="aiPrompt_randomActive" name="aiPrompt_randomActive" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_inGameRandom">Prompt para "Mensagem Aleatória (Durante o Jogo)":</label>
                <textarea id="aiPrompt_inGameRandom" name="aiPrompt_inGameRandom" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_chatSummary">Prompt para "Resumo do Chat": (Use {CHAT_PLACEHOLDER} onde o chat deve ser inserido)</label>
                <textarea id="aiPrompt_chatSummary" name="aiPrompt_chatSummary" rows="6"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_status_closed">Prompt para IA de "Status Fechado":</label>
                <textarea id="aiPrompt_status_closed" name="aiPrompt_status_closed" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_status_openingSoon">Prompt para IA de "Status Abrindo em Breve":</label>
                <textarea id="aiPrompt_status_openingSoon" name="aiPrompt_status_openingSoon" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_status_open">Prompt para IA de "Status Aberto":</label>
                <textarea id="aiPrompt_status_open" name="aiPrompt_status_open" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_newMember">Prompt para IA de "Novo Membro":</label>
                <textarea id="aiPrompt_newMember" name="aiPrompt_newMember" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_memberLeft">Prompt para IA de "Membro Saiu":</label>
                <textarea id="aiPrompt_memberLeft" name="aiPrompt_memberLeft" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_extras_sundayNight">Prompt para IA de "Extra: Domingo à Noite":</label>
                <textarea id="aiPrompt_extras_sundayNight" name="aiPrompt_extras_sundayNight" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_extras_friday">Prompt para IA de "Extra: Sexta-feira":</label>
                <textarea id="aiPrompt_extras_friday" name="aiPrompt_extras_friday" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_messageDeleted">Prompt para IA de "Mensagem Apagada":</label>
                <textarea id="aiPrompt_messageDeleted" name="aiPrompt_messageDeleted" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="aiPrompt_randomJoke">Prompt para IA de "Piada Aleatória":</label>
                <textarea id="aiPrompt_randomJoke" name="aiPrompt_randomJoke" rows="3"></textarea>
            </div>
        </section>



    </div>

    <script src="admin.js"></script>
</body>
</html> 